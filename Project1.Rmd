---
title: "Flgiht Data"
author: "Brandon Mayo and Sam Burk"
date: "2024-02-13"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(scales)
library(RSocrata)
library(openintro)
library(mosaic)
library(lubridate)
library(dplyr)
library(maps)
library(sf)
library(tmap)
```

# Data Background

```{r}
flights <- read.csv("rawflight.csv")

airports <- read.csv("airports.csv")

clean_ports <- airports %>% 
  transmute(
    airport_id, name, state, city
  ) %>% 
  mutate(OriginAirportID=airport_id, OriginAirportID=as.numeric(OriginAirportID)) %>% 
  mutate(DestAirportID=airport_id, DestAirportID=as.numeric(DestAirportID))

clean_flights <- flights %>% 
  transmute(week_day=wday(DayOfWeek, label=T, abbr=T),
            DayofMonth, Carrier, DepDelay, ArrDelay, OriginAirportID, DestAirportID) %>%
  mutate(OriginAirportID=as.numeric(OriginAirportID), DestAirportID=as.numeric(DestAirportID)) #%>% 
  #full_join(flights, clean_ports, by="OriginAirportID") %>% 
  #full_join(flights,clean_ports, by="DestAirportID")


```


# Exploratory Data Analysis
## Questions



Audience are common people looking for information about airlines and airports.

1. Overall distribution of departure and arrival delays. (all data)

```{r}
#Chicago airport id's: 13232, 13930

clean_flights %>% 
  filter(!is.na(DepDelay), !is.na(ArrDelay)) %>% 
  ggplot() + 
  geom_density(aes(x = DepDelay, color = "DepDelay")) +  # Specify color as "DepDelay"
  geom_density(aes(x = ArrDelay, color = "ArrDelay")) +  # Specify color as "ArrDelay"
  geom_vline(xintercept = 0, linetype = "dashed") +
  labs(
    title = "Distribution of Departure and Arrival Delays",
    x = "Delay (minutes)",
    y = "Density",
    color = "Delay Type"
  ) +
  scale_x_continuous(limits = c(-120, 120)) +
  scale_color_brewer(palette = "Dark2", labels = c("Arrival Delay", "Departure Delay"))  # Specify labels
```

2. Specific weekdays that have higher average delays. (all data)

```{r}
clean_flights %>% 
  filter(!is.na(DepDelay), !is.na(ArrDelay)) %>%
  group_by(week_day) %>% 
  summarize(avg_dep_delay = mean(DepDelay),
            avg_arr_delay = mean(ArrDelay)) %>%
  pivot_longer(cols = c(avg_dep_delay, avg_arr_delay),
               names_to = "delay_type",
               values_to = "avg_delay") %>%
  ggplot(aes(x = week_day, y = avg_delay, fill = delay_type)) + 
    geom_col(position = "dodge") +
    geom_text(position = position_dodge(width = .9), vjust = -0.45, aes(label=round(avg_delay, 2))) +
  labs(
    title = "Average Delay on Days of the Week",
    x = "Day",
    y = "Average Delay (minutes)",
    fill = "Delay Type"
  ) +
  scale_fill_brewer(palette = "Accent", labels = c("Arrival Delay", "Departure Delay"))
```

4. Specific carriers that have the highest average departure and arrival delays. (Chicago land airports & all data)
6. Which airports experience the most delays. (all data, but show top 5 airports)


# Report


Final graph make it a interactive point graph on a US map which tells; airport name, city, state, average departure delay, average arrival delay, number of flight arrivals, number of flight delays.




